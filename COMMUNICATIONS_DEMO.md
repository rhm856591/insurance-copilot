# Communications Demo Guide

## âœ… System Status: FULLY FUNCTIONAL

The WhatsApp, Email, and SMS integration is now live and working!

---

## ğŸ¯ How to Use

### From Leads Page:

1. **Navigate to Leads** (`/leads`)
2. **Click "Send Message"** on any lead card
3. **Select Channel**:
   - ğŸ“± WhatsApp (if phone available)
   - ğŸ“§ Email (if email available)
   - ğŸ’¬ SMS (if phone available)
4. **Enter Prompt**: 
   - "Send a follow-up about ULIP inquiry"
   - "Send policy renewal reminder"
   - "Follow up on term life insurance discussion"
5. **Click "Generate Message with AI"**
6. **Review** the generated message
7. **Edit** if needed
8. **Click "Send Now"**
9. **Success!** Message sent via selected channel

### From Customers Page:

1. **Navigate to Customers** (`/customers`)
2. **Click "Send Message"** on any customer
3. Follow same steps as above
4. Context is automatically filled based on customer data

---

## ğŸ“± Demo Scenarios

### Scenario 1: Policy Renewal Reminder

**Recipient**: Rajesh Kumar  
**Channel**: WhatsApp  
**Prompt**: "Send a policy renewal reminder"

**Generated Message**:
```
Dear Rajesh Kumar,

This is a friendly reminder that your life insurance policy is due for renewal soon.

Policy Details:
â€¢ Policy Number: LIC8921
â€¢ Renewal Date: November 20, 2024
â€¢ Premium Amount: â‚¹45,000

To ensure uninterrupted coverage, please complete your renewal payment by the due date.

Benefits of timely renewal:
âœ“ Continuous coverage protection
âœ“ No medical re-examination required
âœ“ Maintain your existing policy benefits

Best regards,
Insurance AI Copilot
```

### Scenario 2: Lead Follow-up

**Recipient**: Priya Sharma  
**Channel**: Email  
**Prompt**: "Follow up on ULIP inquiry"

**Generated Email**:
```
Subject: Following Up on Your ULIP Inquiry

Dear Priya Sharma,

I hope this message finds you well. I wanted to follow up on our recent discussion about ULIP (Unit Linked Insurance Plan).

I understand that choosing the right investment-linked insurance plan is an important decision. I'm here to help answer any questions you may have about:

âœ“ Fund options (Equity, Debt, Balanced)
âœ“ Premium payment flexibility
âœ“ Tax benefits under Section 80C
âœ“ Switching between funds

Would you be available for a brief call this week to discuss your requirements in detail?

Looking forward to hearing from you.

Best regards,
Insurance AI Copilot
```

### Scenario 3: Quick SMS

**Recipient**: Amit Patel  
**Channel**: SMS  
**Prompt**: "Quick reminder about scheduled call"

**Generated SMS**:
```
Hi Amit, this is a reminder about our scheduled call today at 3:00 PM to discuss your child education plan. Looking forward to speaking with you! - Insurance AI Copilot
```

---

## ğŸ”§ Current Mode: MOCK

The system is currently running in **MOCK MODE** because API keys are not configured.

### What Happens in Mock Mode:
- âœ… Messages are generated by AI
- âœ… UI works perfectly
- âœ… Messages are logged to console
- âœ… Mock message IDs are returned
- âŒ No actual messages are sent

### Console Output Example:
```
WhatsApp (Mock): {
  to: '+91 98765 43210',
  body: 'Dear Rajesh Kumar...'
}

Email (Mock): {
  to: 'priya@example.com',
  subject: 'Following Up on Your ULIP Inquiry',
  body: 'Dear Priya Sharma...'
}

SMS (Mock): {
  to: '+91 98765 43212',
  body: 'Hi Amit, this is a reminder...'
}
```

---

## ğŸš€ Enable Real Sending

To send actual messages, configure API keys in `.env.local`:

### For WhatsApp:
```env
WHATSAPP_API_URL=https://graph.facebook.com/v18.0
WHATSAPP_PHONE_NUMBER_ID=your_phone_number_id
WHATSAPP_ACCESS_TOKEN=your_access_token
```

### For Email (SendGrid):
```env
EMAIL_SERVICE=sendgrid
SENDGRID_API_KEY=SG.xxxxxxxxxxxxx
FROM_EMAIL=noreply@yourcompany.com
FROM_NAME=Insurance AI Copilot
```

### For SMS (Twilio):
```env
TWILIO_ACCOUNT_SID=ACxxxxxxxxxxxxx
TWILIO_AUTH_TOKEN=your_auth_token
TWILIO_PHONE_NUMBER=+1234567890
```

See `COMMUNICATIONS_SETUP.md` for detailed setup instructions.

---

## ğŸ¨ UI Features

### Send Message Modal:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Send Message              To: Rajesh K. â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚ Select Channel:                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”            â”‚
â”‚ â”‚  ğŸ“±  â”‚ â”‚  ğŸ“§  â”‚ â”‚  ğŸ’¬  â”‚            â”‚
â”‚ â”‚WhatsAâ”‚â”‚Email â”‚â”‚ SMS  â”‚            â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                         â”‚
â”‚ Message Context / Prompt:               â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Send a policy renewal reminder      â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                         â”‚
â”‚ [âœ¨ Generate Message with AI]          â”‚
â”‚                                         â”‚
â”‚ Generated Message:                      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Dear Rajesh Kumar,                  â”‚ â”‚
â”‚ â”‚                                     â”‚ â”‚
â”‚ â”‚ This is a friendly reminder...      â”‚ â”‚
â”‚ â”‚                                     â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                         â”‚
â”‚ [Cancel]              [ğŸ“¤ Send Now]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Success Message:
```
âœ… Message sent successfully via whatsapp!
   Message ID: wa_1234567890
```

---

## ğŸ“Š Features

### AI Generation:
- âœ… Context-aware messages
- âœ… Professional tone
- âœ… IRDAI compliant
- âœ… Customizable templates
- âœ… Multi-language ready

### Channel Support:
- âœ… WhatsApp Business API
- âœ… Email (SendGrid/Gmail)
- âœ… SMS (Twilio)
- âœ… Auto-detect available channels
- âœ… Fallback options

### Compliance:
- âœ… Prohibited terms detection
- âœ… IRDAI guidelines enforcement
- âœ… Message audit trail
- âœ… Pre-send validation

### User Experience:
- âœ… One-click generation
- âœ… Edit before sending
- âœ… Real-time status
- âœ… Error handling
- âœ… Mobile-optimized

---

## ğŸ§ª Testing

### Test the UI:

1. **Go to Leads page**: http://localhost:3000/leads
2. **Click "Send Message"** on Rajesh Kumar
3. **Select WhatsApp**
4. **Enter**: "Send a follow-up about term life insurance"
5. **Click "Generate Message with AI"**
6. **Review** the generated message
7. **Click "Send Now"**
8. **Check console** for mock output

### Test Different Channels:

1. **WhatsApp**: Short, conversational messages
2. **Email**: Formal with subject line
3. **SMS**: Very brief, under 160 characters

### Test Different Prompts:

- "Send a policy renewal reminder"
- "Follow up on ULIP inquiry"
- "Send policy information"
- "Schedule a call"
- "Thank you message"

---

## ğŸ“ API Testing

### Test Generate Endpoint:

```bash
curl -X POST http://localhost:3000/api/communications/generate \
  -H "Content-Type: application/json" \
  -d '{
    "prompt": "Send a policy renewal reminder",
    "recipient": {
      "name": "Rajesh Kumar"
    },
    "channel": "whatsapp"
  }'
```

### Test WhatsApp Endpoint:

```bash
curl -X POST http://localhost:3000/api/communications/whatsapp \
  -H "Content-Type: application/json" \
  -d '{
    "to": "+919876543210",
    "body": "Test message"
  }'
```

### Test Email Endpoint:

```bash
curl -X POST http://localhost:3000/api/communications/email \
  -H "Content-Type: application/json" \
  -d '{
    "to": "test@example.com",
    "subject": "Test Email",
    "body": "This is a test message"
  }'
```

---

## ğŸ¯ Next Steps

### For Demo:
1. âœ… Use mock mode (current)
2. âœ… Show UI and generation
3. âœ… Demonstrate compliance checking
4. âœ… Show audit trail

### For Production:
1. Set up API accounts
2. Configure environment variables
3. Test with real numbers/emails
4. Enable rate limiting
5. Set up monitoring
6. Deploy to production

---

## ğŸ“š Documentation

- `COMMUNICATIONS_SETUP.md` - Detailed setup guide
- `COMMUNICATIONS_DEMO.md` - This file
- `.env.example` - Environment variables template
- API routes in `src/app/api/communications/`

---

## âœ¨ Success!

The communications system is fully functional and ready to use!

**Features Working:**
- âœ… AI message generation
- âœ… Multi-channel support (WhatsApp, Email, SMS)
- âœ… Compliance checking
- âœ… Mobile-optimized UI
- âœ… Real-time status updates
- âœ… Mock mode for testing
- âœ… Production-ready architecture

**Try it now at:** http://localhost:3000/leads

Click "Send Message" on any lead to see it in action! ğŸš€
